name: Simple Go CI Pipeline

on:
  push:
    branches: [ main ]  # 当push到main分支时触发
  pull_request:
    branches: [ main ]  # 当PR到main分支时触发

jobs:
  build-and-test:
    runs-on: ubuntu-latest  # 使用Ubuntu环境
    steps:
      - name: Checkout code
        uses: actions/checkout@v4  # 拉取仓库代码

      - name: Set up Go
        uses: actions/setup-go@v5  # 设置Go环境
        with:
          go-version: '1.21'  # 替换为你的Go版本（检查go.mod）

      - name: Install dependencies
        run: go mod tidy  # 安装依赖（如果有go.mod）

      - name: Build
        run: go build -v ./...  # 构建项目（编译main.go）

      - name: Test
        run: go test -v ./...  # 运行测试（如果有_test.go文件）

      - name: Run and Verify
        run: go run go.go  # 运行代码并输出（可选，用于验证交替打印）